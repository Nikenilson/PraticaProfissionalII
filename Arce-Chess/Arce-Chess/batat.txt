@section scripts {
    <!--Script references. -->
    <!--The jQuery library is required and is referenced by default in _Layout.cshtml. -->
    <!--Reference the SignalR library. -->
    <script src="~/Scripts/jquery.signalR-2.2.2.min.js"></script>
    <!--Reference the autogenerated SignalR hub script. -->
    <script src="~/signalr/hubs"></script>
    <!--SignalR script to update the chat page and send messages.-->
    
    <!--
    if (usuAt == htmlEncode(name))
        $('#discussion').append('<div class="usu"><div class="imgUser"><img src="@ViewBag.Usuario.ImgPerfil"></div><li class="usuu"><span>'
        + htmlEncode(message) + '</span></li><div>');
    if(idAmizade == "@ViewBag.AmizadeId")
        $('#discussion').append('<div class="mensagem"><div class="imgUser"><img src="@ViewBag.User.ImgPerfil"></div><li><span>'
        + htmlEncode(message) + '</span></li><div>');
    -->
    <script>
        $(function () {
            // Reference the auto-generated proxy for the hub.
            var chess = $.connection.chessHub;
            // Create a function that the hub can call back to display messages.
            chess.client.moverPiece = function (x, y, idAmizade) {

                if (idAmizade == "@ViewBag.AmizadeId") {
                    var event = $.Event('click');
                    event.clientX = x;
                    event.clientY = y;
                    $('game').trigger(event);
                }
            };

            /*this.canvas.
                addEventListener('click', function (event) {
                    var x = event.pageX - elemLeft,
                        y = event.pageY - elemTop;*/

            // Start the connection.
            $.connection.hub.start().done(function () {
                $("game").click(function (e) {
                    var xInicial = e.pageX,
                        yInicial = e.pageY;
                    chess.server.moverPiece(xInicial, yInicial, "@ViewBag.AmizadeId");
                });
                $("game").click(function (e) {
                    var xFinal = e.pageX,
                        yFinal = e.pageY;
                   chess.server.moverPiece(xFinal, yFinal, "@ViewBag.AmizadeId");
                });
            });

    </script>
}
